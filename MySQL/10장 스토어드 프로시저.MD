## 스토어드 프로시저

- MySQL에서 제공되는 프로그래밍 기능
- 쿼리문의 집합으로 어떤 동작을 일괄 처리하기 위한 용도로 사용
- 스토어드 함수는 반환하는 값이 반드시 나온다.
- 쿼리 모듈화
    - 필요할 때마다 호출만 하면 훨씬 편리하게 MySQL 운영
    - CALL 프로시저_이름() 으로 호출

```sql
#기본형식
형식 : 
DELIMITER $$
CREATE PROCEDURE 스토어드 프로시저이름(IN 또는 OUT 파라미터)
BEGIN

	SQL 프로그램 코딩

END $$
DELIMITER;
CALL 스토어드 프로시저이름();

#예시
DELIMITER $$
CREATE PROCEDURE userProc()
BEGIN
	SELECT * FROM userTbl; -- 스토어드 프로시저 내용
END $$
DELIMITER;

CALL userProc();
```

- 스토어드 프로시저의 수정과 삭제
    - 수정 : ALTER PROCEDURE
    - 삭제 : DROP PROCEDURE
- 매개변수의 사용
    - 입력 매개변수를 지정하는 형식
        - IN 입렵_매개변수_이름 데이터_형식
    - 입력 매개변수가 있는 스토어드 프로시저 실행 방법
        - CALL 프로시저_이름(전달 값);
    - 출력 매개 변수 지정 방법
        - OUT 출력_매개변수_이름 데이터_형식
    - 출력 매개 변수에 값 대입하기 위해 주로 SELECT INTO문 사용
    - 출력 매개 변수가 있는 스토어드 프로시저 실행 방법
    - CALL 프로시저_이름(@변수명);
        
        SELECT @변수명;
        

```sql
#출력매개변수 설정
-- 스토어드 프로시저 생성 및 테스트로 사용할 테이블 생성
DELiMITER $$
CREATE PRocedure userProc3(
	In txtValue Char(10),
    out outvalue int
)
Begin
	insert into testTbl values(null, txtvalue);
    select max(id) into outvalue from testTbl;
End $$
DELIMITER ;

-- 테스트 테이블 생성 후
CREATE table if not exists testTbl(
	id int Auto_increment primary key,
    txt char(10)
);

-- 매개변수로 호출하여 실행한다.
call userProc3('테스트값', @myValue);

-- concat을 이용하여 이어 붙인다.
select concat('현재 입력된 ID 값 ==>', @myValue);
```
